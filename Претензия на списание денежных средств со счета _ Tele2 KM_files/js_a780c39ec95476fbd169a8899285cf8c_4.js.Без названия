$(document).ready(function() {
  var role = Drupal.t('Current role: !role',{'!role': $('#granted_role').text()});
  var textname = $('#block-jmp_switchrole-0 h2.title').text();
  var name = $('#block-jmp_switchrole-0 h2.title').html();
  $('#block-jmp_switchrole-0 h2.title').html('&nbsp;').
    click(function(){$('#block-jmp_switchrole-0 .content').toggle();}).attr('title', textname+' '+role);
  $('#block-jmp_switchrole-0 .content').prepend("<div class='username'>"+name+"</div>");
  $('#block-jmp_switchrole-0 .content').
    click(function(){$('#block-jmp_switchrole-0 .content').hide();});
});;/**/
/* Source and licensing information for the line(s) below can be found at http://kmumb.tele2.ru/themes/km_remote_big/leftside_block.js. */
$.fn.clicktoggle=function(a,b){return this.each(function(){var clicked=false;$(this).unbind('click').bind('click',function(){if(clicked){clicked=false;return b.apply(this,arguments)};clicked=true;return a.apply(this,arguments)})})};$(document).ready(function(){if(typeof(Drupal.settings.km_userui)=="undefined")return;$("#edit-searchbox").focus();$("body").bind('resize_solution',function(obj){$("#edit-searchbox").focus()});var height=Drupal.settings.km_userui.cr_display_limit*1.2*22+132;$("#sidebar-right-slide-border").css("height",height+"px");$("#sidebar-right-slide-button").css("top",height/2+"px");$("#sidebar-right").css("height",$("#sidebar-right-slide").height()+200+"px");$("#sidebar-right-slide-button, #sidebar-right-slide-border").clicktoggle(function(){$("#sidebar-right > .km_region").hide();$("#sidebar-right").css("height",height+200+"px");$("#sidebar-right #sidebar-right-slide").show();$("#sidebar-right-slide-button").css("right","200px").css("top",height/2+"px").removeClass("back-transform");$("#sidebar-right-slide-border").css("right","215px").css("height",height+"px");$("#sidebar-right .sidebar-right-body").hide()},function(){$("#sidebar-right > .km_region").show();$("#sidebar-right #sidebar-right-slide").hide();$("#sidebar-right-slide-button").css("right","-20px").addClass("back-transform");$("#sidebar-right-slide-border").css("right","-5px");$("#sidebar-right .sidebar-right-body").show()})});;
/* Source and licensing information for the above line(s) can be found at http://kmumb.tele2.ru/themes/km_remote_big/leftside_block.js. */
/*
 * jQuery resize event - v1.1 - 3/14/2010
 * http://benalman.com/projects/jquery-resize-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,h,c){var a=$([]),e=$.resize=$.extend($.resize,{}),i,k="setTimeout",j="resize",d=j+"-special-event",b="delay",f="throttleWindow";e[b]=100;e[f]=true;$.event.special[j]={setup:function(){if(!e[f]&&this[k]){return false}var l=$(this);a=a.add(l);$.data(this,d,{w:l.width(),h:l.height()});if(a.length===1){g()}},teardown:function(){if(!e[f]&&this[k]){return false}var l=$(this);a=a.not(l);l.removeData(d);if(!a.length){clearTimeout(i)}},add:function(l){if(!e[f]&&this[k]){return false}var n;function m(s,o,p){var q=$(this),r=$.data(this,d);r.w=o!==c?o:q.width();r.h=p!==c?p:q.height();n.apply(this,arguments)}if($.isFunction(l)){n=l;return m}else{n=l.handler;l.handler=m}}};function g(){i=h[k](function(){a.each(function(){var n=$(this),m=n.width(),l=n.height(),o=$.data(this,d);if(m!==o.w||l!==o.h){n.trigger(j,[o.w=m,o.h=l])}});g()},e[b])}})(jQuery,this);;/**/
/* Source and licensing information for the line(s) below can be found at http://kmumb.tele2.ru/sites/all/modules/km/jscript/kmdecisions.js. */
$(document).ready(function(){mark_decisions()})
function doGray(el){$(el).addClass('decisiontreegray');$(el).parent().find(".cattree, #box-check-sms").remove();if($(el).parent("fieldset.decisiontree").hasClass("decisiontree"))doGray(parent)};var flag_send_to_umbrella_collapsible=0
function toogle_button_cat_tree(fieldset){if(typeof(fieldset.attr("cat_tree"))!="undefined"&&fieldset.attr("cat_tree")!="undefined"&&typeof(Drupal.settings.arrayTemplateSms)!="undefined"){var tid=fieldset.attr("cat_tree");if($('#km-cr-tree-'+tid,'#ts-km-cr-tree').val()!=tid)return;fieldset.find(".cattree, #box-check-sms").remove();var button=$('<div id="box-check-sms" class="input-sms"><input type="checkbox" class="collapsed-sms" id="check-sms"><span>'+Drupal.t('Automated send sms')+'</span></div><button cat_tree="'+tid+'" class="cattree">'+Drupal.t("Add CR")+'</button>');button.click(function(){var $this=$(this),tid=new Array($this.attr('cat_tree'));if(tid[0]){var status_sms='',_className=new String();_className=$this.parent().find("#box-check-sms").attr("class");if(typeof _className!="undefined"){if(_className.indexOf("time-sms")!==-1){if($this.parent().parent().find('.collapsed-sms').attr("checked")==true){status_sms=-1}else status_sms=-2}else if($this.parent().parent().find('.collapsed-sms').css("display")=="none"){status_sms=0}else if($this.parent().parent().find('.collapsed-sms').attr("checked")==true){status_sms=1}else status_sms=2}else status_sms=0;$("body").trigger('cr_log_submit',{taxonomy_1:tid,element:$this,sms:status_sms})};if(!Drupal.settings.km_userui.same_screen)Boxy.get(this).hide()});fieldset.append(button);if(tid in Drupal.settings.arrayTemplateSms){if(Drupal.settings.arrayTemplateSms[tid]==true)$("#box-check-sms").removeClass('time-sms').addClass('input-sms').show();if(Drupal.settings.arrayTemplateSms[tid]==false)$("#box-check-sms").removeClass('input-sms').addClass('time-sms').show();$("#check-sms").attr("checked",true)}else{$("#box-check-sms").hide();$("#check-sms").attr("checked",false)}};if(typeof(fieldset.attr("cat_umb"))!="undefined"&&fieldset.attr("cat_umb")!="undefined"&&typeof(Drupal.settings.km_filter)!="undefined"&&typeof(Drupal.settings.km_filter.umbrella_msisdn)!="undefined"){var tid=fieldset.attr("cat_umb"),tid_sub=fieldset.attr("cat_umb_sub"),button=$('<button cat_umb="'+tid+'" cat_umb_sub="'+tid_sub+'" class="cattree">'+Drupal.t("Add CR")+'</button>');button.click(function(){var $this=$(this);if(!flag_send_to_umbrella_collapsible){flag_send_to_umbrella_collapsible=1;$.getJSON('/js/km_umbrella/collapsible_usage_umbrella/'+$this.attr('cat_umb')+'/'+$this.attr('cat_umb_sub')+window.location.search,function(data){flag_send_to_umbrella_collapsible=0;if(!data.status)Boxy.alert(data.message,null,{title:Drupal.t('Error'),unloadOnHide:true})})};if(!Drupal.settings.km_userui.same_screen)Boxy.get(this).hide()});fieldset.append(button)}}
function mark_decisions(){$("fieldset.decisiontree").not(".collapsed").each(function(){$(this).addClass('open-forever')});$("fieldset.decisiontree legend").unbind('click');$("fieldset.decisiontree legend").click(function(){var $this=$(this);if($this.parent().hasClass("collapsed")){$("fieldset.decisiontree").addClass("collapsed").removeClass("lastSection").removeClass("decisiontreegray").find(".cattree, #box-check-sms").remove();$("fieldset.decisiontree.open-forever").removeClass("collapsed");$this.parents("fieldset.decisiontree").removeClass("collapsed");$this.parent().addClass("lastSection");var parent=$this.parent("fieldset.decisiontree").parents("fieldset.decisiontree");try{var siblings=parent.find("fieldset.collapsed:visible");siblings.each(function(){var ext_parent=$(this).parents("fieldset.decisiontree").not("[class*='lastSection']");if($(this).parents("fieldset.decisiontree")[0]==ext_parent[0])doGray($(this))});var siblings_close=parent.find("fieldset:visible").not("[class*='collapsed']");siblings_close.each(function(){if($(this).find("fieldset:visible").not("[class*='collapsed']").length==0)if($this.parent("fieldset")[0]!=$(this)[0])if($(this).hasClass("lastSection")){$(this).addClass("collapsed")}else $(this).addClass("lastSection")})}catch(e){};if(parent.hasClass("decisiontree"))doGray(parent);toogle_button_cat_tree($this.parent())}else{$this.parent().addClass("collapsed");$this.removeClass("lastSection");$this.parent().removeClass("lastSection").removeClass("decisiontreegray");var p=$($this.parents("fieldset.decisiontree")[1]);p.removeClass("decisiontreegray");p.find(".decisiontreegray").removeClass("decisiontreegray");$this.parent().find(".cattree, #box-check-sms").remove();toogle_button_cat_tree(p)};$this=null});$("fieldset.decisiontree legend[title!='']").each(function(){var $this=$(this),message=$this.attr('title');$(this).attr('title','');message=message.replace(/[^(<\/li>)|(<\/ul>)|(<\/ol>)]\n/g,'<br />');var infolink='<a class="infohint" href="#">&nbsp</a>';$this.append(infolink);$this.find(".infohint").click(function(){Boxy.alert(message,null,{title:Drupal.t('Information')});return false});$this=null});$("fieldset.decisiontree a.decisiontreeGoTo").unbind('click');$("fieldset.decisiontree a.decisiontreeGoTo").click(function(){var linkid='#'+$(this).attr('href').split('#').pop();$(linkid).click()})};
/* Source and licensing information for the above line(s) can be found at http://kmumb.tele2.ru/sites/all/modules/km/jscript/kmdecisions.js. */
